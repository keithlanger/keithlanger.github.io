import{j as e,b as S,c as P,M as C,F as u,B as k,P as y,C as w,R as $,a as D}from"./bootstrap-6w9hth4I.js";import{h as I,f as N}from"./fields-DsoNZccK.js";import{r as F}from"./vendor-CAgi6j6b.js";import{y as V}from"./index-BiwJG4Ts.js";import"./router-CE-yxLYx.js";function L(){const n="https://abc.dev.cloudids.aero/images/";function g(t,d){d||(d="h:mm A");var c=I(t).format(d);return c}function j(t,d,c,m,l){var b;m||(m="default"),l||(l="en");var r=o(t,c),x=`${c}/${r}/${l}/${m}`.toLowerCase(),s=((b=d[x])==null?void 0:b.value)??r;return s}function o(t,d){var m,l;var c=(l=(m=t.dailyValues)==null?void 0:m.find(r=>r.field==d&&r.instance==1))==null?void 0:l.value;return c||""}function i(t,d){var c=o(t,d);return c}function p(t,d){var c={id:t.id,adi:t==null?void 0:t.adi,schedule:g(t==null?void 0:t.schedule),iata:o(t,"city"),city:j(t,d,"city"),logo:n+i(t,"logo"),linecode:i(t,"linecode"),number:i(t,"number"),gate:o(t,"gate"),status:j(t,d,"status"),statusCode:o(t,"status"),linecodeNumber:i(t,"linecode")+" "+i(t,"number")};return c}return{getFormattedFlight:p,formatTime:g,getLookup:j,getDailyValue:o,getCodeshareField:i}}const v=new L;function T({flight:n,showFlight:g,fields:j}){var o=v.getFormattedFlight(n,j);return e.jsx(S,{className:"myCard",onClick:()=>g(n),children:e.jsxs(S.Body,{children:[e.jsxs(S.Title,{children:[n.id," (",n.adi,") ",o.linecode,o.number]}),e.jsxs(P,{children:[e.jsx("img",{src:o.logo}),e.jsx("div",{children:o.iata}),e.jsx("div",{children:o.city}),e.jsx("div",{children:o.gate}),e.jsx("div",{children:o.status}),e.jsx("div",{children:o.schedule})]})]})})}function U({flight:n,fields:g,show:j,handleClose:o}){const i="https://localhost:5001/v1/api/Dailies",p=v.getFormattedFlight(n,g),t=(l,r)=>{console.log("Updating flight "+l);const x=i+"/UpdateDailyValues/"+l;fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>{console.log("Updating flight succeeded - Data:",s),o(),V.success("Record was saved successfully")}).catch(s=>{console.error("Error Updating flight:",s),V.error("Record did not save successfully.  Error reported: "+s)})};function d(){return v.getCodeshareField(n,"linecode")+" "+v.getCodeshareField(n,"number")}function c(l,r,x){var s={field:l,instance:1,value:r};x.push(s)}const m=l=>{l.preventDefault(),console.log("Submit"),console.log(l.target);const r=[];c("gate",l.target.gate.value,r),c("city",l.target.city.value,r),c("status",l.target.status.value,r);for(let x=0;x<r.length;x++){const s=r[x];n.dailyValues||(n.dailyValues=[]);const b=n.dailyValues.find(f=>f.field==s.field&&f.instance==s.instance);b?b.value=s.value:n.dailyValues.push(s)}console.log("Updating flight "+n.id),console.log(r),t(n.id,r)};return e.jsxs(C,{show:j,onHide:o,children:[e.jsx(C.Header,{closeButton:!0,children:e.jsx(C.Title,{children:d()})}),e.jsx(C.Body,{children:e.jsxs(u,{onSubmit:m,children:[e.jsxs(u.Group,{className:"mb-3",controlId:"id",children:[e.jsx(u.Label,{children:"ID"}),e.jsx(u.Control,{type:"text",disabled:!0,value:n.id})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"linecode_number",children:[e.jsx(u.Label,{children:"Flight"}),e.jsx(u.Control,{type:"text",disabled:!0,defaultValue:p.linecodeNumber})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"gate",children:[e.jsx(u.Label,{children:"Gate"}),e.jsx(u.Control,{type:"text",defaultValue:p.gate})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"city",children:[e.jsx(u.Label,{children:"City"}),e.jsx(u.Control,{type:"text",defaultValue:p.iata})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"status",children:[e.jsx(u.Label,{children:"Status"}),e.jsx(u.Control,{type:"text",defaultValue:p.statusCode})]}),e.jsx(k,{type:"submit",variant:"primary",children:"Save Changes"}),e.jsx("span",{className:"p-2"}),e.jsx(k,{variant:"secondary",onClick:o,children:"Cancel"})]})}),e.jsx(C.Footer,{})]})}const B="https://localhost:5001/v1/api/Dailies",E=600,R=-30;function J(){console.log("Using simple APIs V1");const[n,g]=F.useState(!1),[j,o]=F.useState({}),[i,p]=F.useState(1),[t,d]=F.useState([]);let c=50,m=1;const l=()=>{console.log("Fetching data");const a=`${B}/GetFlightsByTimeRange?rollOn=${E}&rollOff=${R}&maxRecords=${c}`;console.log("Fetching URL: "+a),fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}).then(h=>{if(!h.ok)throw new Error(`HTTP error! Status: ${h.status}`);return h.json()}).then(h=>{console.log("Data:",h),d(h)}).catch(h=>{console.error("Error fetching data:",h)})};F.useEffect(()=>{l()},[]);const r=()=>g(!1);function x(a){o(a),g(!0)}function s(a){a>=1&&a<=m?(console.log("Setting page to "+a),p(a)):console.log("Not setting page because page is out of range: "+a)}function b(a){var h=parseInt(a.target.text);console.log("itemClicked: "+h),s(h)}console.log("Current page: "+i);let f=[];for(let a=1;a<=m;a++)f.push(e.jsx(y.Item,{active:a===i,onClick:h=>b(h),children:a},a));return e.jsxs(e.Fragment,{children:[e.jsxs(w,{children:[e.jsxs(y,{children:[e.jsx(y.First,{onClick:()=>s(1),disabled:i==1}),e.jsx(y.Prev,{onClick:()=>s(i-1),disabled:i==1}),f,e.jsx(y.Next,{onClick:()=>s(i+1),disabled:i==m}),e.jsx(y.Last,{onClick:()=>s(m),disabled:i==m})]}),e.jsx($,{xs:2,md:5,children:t.map(a=>e.jsx(D,{className:"mb-3",children:e.jsx(T,{flight:a,fields:N,showFlight:x})},a.id))})]}),e.jsx(U,{show:n,flight:j,fields:N,handleClose:r})]})}export{J as default};
//# sourceMappingURL=FlightsSimple-DzZJ9nRu.js.map
