import{j as e,b as f,c as U,M as C,F as m,B as k,P as b,C as $,R as B,a as I}from"./bootstrap-6w9hth4I.js";import{h as L,f as N}from"./fields-DsoNZccK.js";import{r as y}from"./vendor-CAgi6j6b.js";import{y as w}from"./index-BiwJG4Ts.js";import"./router-CE-yxLYx.js";function T(){const u="https://abc.dev.cloudids.aero/images/";function j(t,c){c||(c="h:mm A");var n=L(t).format(c);return n}function g(t,c,n,d,s){var F;d||(d="default"),s||(s="en");var a=o(t,n),h=`${n}/${a}/${s}/${d}`.toLowerCase(),l=((F=c[h])==null?void 0:F.value)??a;return l}function o(t,c){var d,s,a;var n=(a=(s=(d=t==null?void 0:t.fields)==null?void 0:d[c])==null?void 0:s[0])==null?void 0:a.value;return n}function i(t,c){var d,s,a,h;var n=(h=(a=(s=(d=t==null?void 0:t.fieldGroups)==null?void 0:d.codeshares)==null?void 0:s[0])==null?void 0:a[c])==null?void 0:h.value;return n||(n=o(t,c)),n}function p(t,c){var n={id:t.id,adi:t==null?void 0:t.adi,schedule:j(t==null?void 0:t.schedule),iata:o(t,"city"),city:g(t,c,"city"),logo:u+i(t,"logo"),linecode:i(t,"linecode"),number:i(t,"number"),gate:o(t,"gate"),status:g(t,c,"status"),statusCode:o(t,"status"),linecodeNumber:i(t,"linecode")+" "+i(t,"number")};return n}return{getFormattedFlight:p,formatTime:j,getLookup:g,getDailyValue:o,getCodeshareField:i}}const v=new T;function V({flight:u,showFlight:j,fields:g}){var o=v.getFormattedFlight(u,g);return e.jsx(f,{className:"myCard",onClick:()=>j(u),children:e.jsxs(f.Body,{children:[e.jsxs(f.Title,{children:[u.id," (",u.adi,") ",o.linecode,o.number]}),e.jsxs(U,{children:[e.jsx("img",{src:o.logo}),e.jsx("div",{children:o.iata}),e.jsx("div",{children:o.city}),e.jsx("div",{children:o.gate}),e.jsx("div",{children:o.status}),e.jsx("div",{children:o.schedule})]})]})})}function D({flight:u,fields:j,show:g,handleClose:o}){const i="https://localhost:5001/v2/api/Dailies",p=v.getFormattedFlight(u,j),t=(s,a)=>{console.log("Updating flight "+s);const h=i+"/UpdateDailyValues/"+s;fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(l=>{if(!l.ok)throw new Error(`HTTP error! Status: ${l.status}`);return l.json()}).then(l=>{console.log("Updating flight succeeded - Data:",l),o(),w.success("Record was saved successfully")}).catch(l=>{console.error("Error Updating flight:",l),w.error("Record did not save successfully.  Error reported: "+l)})};function c(){return v.getCodeshareField(u,"linecode")+" "+v.getCodeshareField(u,"number")}function n(s,a,h){var l={field:s,instance:1,value:a};h.push(l),u.fields[s]=[{instance:1,value:a}]}const d=s=>{s.preventDefault(),console.log("Submit"),console.log(s.target);const a=[];n("gate",s.target.gate.value,a),n("city",s.target.city.value,a),n("status",s.target.status.value,a),console.log("Updating flight "+u.id),console.log(a),t(u.id,a)};return e.jsxs(C,{show:g,onHide:o,children:[e.jsx(C.Header,{closeButton:!0,children:e.jsx(C.Title,{children:c()})}),e.jsx(C.Body,{children:e.jsxs(m,{onSubmit:d,children:[e.jsxs(m.Group,{className:"mb-3",controlId:"id",children:[e.jsx(m.Label,{children:"ID"}),e.jsx(m.Control,{type:"text",disabled:!0,value:u.id})]}),e.jsxs(m.Group,{className:"mb-3",controlId:"linecode_number",children:[e.jsx(m.Label,{children:"Flight"}),e.jsx(m.Control,{type:"text",disabled:!0,defaultValue:p.linecodeNumber})]}),e.jsxs(m.Group,{className:"mb-3",controlId:"gate",children:[e.jsx(m.Label,{children:"Gate"}),e.jsx(m.Control,{type:"text",defaultValue:p.gate})]}),e.jsxs(m.Group,{className:"mb-3",controlId:"city",children:[e.jsx(m.Label,{children:"City"}),e.jsx(m.Control,{type:"text",defaultValue:p.iata})]}),e.jsxs(m.Group,{className:"mb-3",controlId:"status",children:[e.jsx(m.Label,{children:"Status"}),e.jsx(m.Control,{type:"text",defaultValue:p.statusCode})]}),e.jsx(k,{type:"submit",variant:"primary",children:"Save Changes"}),e.jsx("span",{className:"p-2"}),e.jsx(k,{variant:"secondary",onClick:o,children:"Cancel"})]})}),e.jsx(C.Footer,{})]})}const E="https://dailyapisimple-gjchg7exhrcxf5cc.centralus-01.azurewebsites.net",P=`${E}/v2/api/Dailies`;console.log("dailiesBaseUrl: "+P);const G=600,R=-30;function J(){console.log("Using simple APIs V2");const[u,j]=y.useState(!1),[g,o]=y.useState({}),[i,p]=y.useState(1),[t,c]=y.useState([]);let n=50,d=1;const s=()=>{console.log("Fetching data");const r=`${P}/GetFlightsByTimeRange?rollOn=${G}&rollOff=${R}&maxRecords=${n}`;console.log("Fetching URL: "+r),fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}}).then(x=>{if(!x.ok)throw new Error(`HTTP error! Status: ${x.status}`);return x.json()}).then(x=>{console.log("Data:",x),c(x)}).catch(x=>{console.error("Error fetching data:",x)})};y.useEffect(()=>{s()},[]);const a=()=>j(!1);function h(r){o(r),j(!0)}function l(r){r>=1&&r<=d?(console.log("Setting page to "+r),p(r)):console.log("Not setting page because page is out of range: "+r)}function F(r){var x=parseInt(r.target.text);console.log("itemClicked: "+x),l(x)}console.log("Current page: "+i);let S=[];for(let r=1;r<=d;r++)S.push(e.jsx(b.Item,{active:r===i,onClick:x=>F(x),children:r},r));return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsxs(b,{children:[e.jsx(b.First,{onClick:()=>l(1),disabled:i==1}),e.jsx(b.Prev,{onClick:()=>l(i-1),disabled:i==1}),S,e.jsx(b.Next,{onClick:()=>l(i+1),disabled:i==d}),e.jsx(b.Last,{onClick:()=>l(d),disabled:i==d})]}),e.jsx(B,{xs:2,md:5,children:t.map(r=>e.jsx(I,{className:"mb-3",children:e.jsx(V,{flight:r,fields:N,showFlight:h})},r.id))})]}),e.jsx(D,{show:u,flight:g,fields:N,handleClose:a})]})}export{J as default};
//# sourceMappingURL=FlightsSimpleV2-BxNs7gvT.js.map
