import{j as e,C as S,y as k,r as C,a as P,R as w,b as $}from"./index-BdlzjqTp.js";import{h as D,S as I,M as F,F as u,B as N,P as y,f as V}from"./fields-DfTMlvG6.js";function L(){const n="https://abc.dev.cloudids.aero/images/";function g(t,d){d||(d="h:mm A");var c=D(t).format(d);return c}function j(t,d,c,h,l){var b;h||(h="default"),l||(l="en");var r=o(t,c),x=`${c}/${r}/${l}/${h}`.toLowerCase(),s=((b=d[x])==null?void 0:b.value)??r;return s}function o(t,d){var h,l;var c=(l=(h=t.dailyValues)==null?void 0:h.find(r=>r.field==d&&r.instance==1))==null?void 0:l.value;return c||""}function i(t,d){var c=o(t,d);return c}function p(t,d){var c={id:t.id,adi:t==null?void 0:t.adi,schedule:g(t==null?void 0:t.schedule),iata:o(t,"city"),city:j(t,d,"city"),logo:n+i(t,"logo"),linecode:i(t,"linecode"),number:i(t,"number"),gate:o(t,"gate"),status:j(t,d,"status"),statusCode:o(t,"status"),linecodeNumber:i(t,"linecode")+" "+i(t,"number")};return c}return{getFormattedFlight:p,formatTime:g,getLookup:j,getDailyValue:o,getCodeshareField:i}}const v=new L;function T({flight:n,showFlight:g,fields:j}){var o=v.getFormattedFlight(n,j);return e.jsx(S,{className:"myCard",onClick:()=>g(n),children:e.jsxs(S.Body,{children:[e.jsxs(S.Title,{children:[n.id," (",n.adi,") ",o.linecode,o.number]}),e.jsxs(I,{children:[e.jsx("img",{src:o.logo}),e.jsx("div",{children:o.iata}),e.jsx("div",{children:o.city}),e.jsx("div",{children:o.gate}),e.jsx("div",{children:o.status}),e.jsx("div",{children:o.schedule})]})]})})}function U({flight:n,fields:g,show:j,handleClose:o}){const i="https://localhost:5001/v1/api/Dailies",p=v.getFormattedFlight(n,g),t=(l,r)=>{console.log("Updating flight "+l);const x=i+"/UpdateDailyValues/"+l;fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(s=>{if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return s.json()}).then(s=>{console.log("Updating flight succeeded - Data:",s),o(),k.success("Record was saved successfully")}).catch(s=>{console.error("Error Updating flight:",s),k.error("Record did not save successfully.  Error reported: "+s)})};function d(){return v.getCodeshareField(n,"linecode")+" "+v.getCodeshareField(n,"number")}function c(l,r,x){var s={field:l,instance:1,value:r};x.push(s)}const h=l=>{l.preventDefault(),console.log("Submit"),console.log(l.target);const r=[];c("gate",l.target.gate.value,r),c("city",l.target.city.value,r),c("status",l.target.status.value,r);for(let x=0;x<r.length;x++){const s=r[x];n.dailyValues||(n.dailyValues=[]);const b=n.dailyValues.find(f=>f.field==s.field&&f.instance==s.instance);b?b.value=s.value:n.dailyValues.push(s)}console.log("Updating flight "+n.id),console.log(r),t(n.id,r)};return e.jsxs(F,{show:j,onHide:o,children:[e.jsx(F.Header,{closeButton:!0,children:e.jsx(F.Title,{children:d()})}),e.jsx(F.Body,{children:e.jsxs(u,{onSubmit:h,children:[e.jsxs(u.Group,{className:"mb-3",controlId:"id",children:[e.jsx(u.Label,{children:"ID"}),e.jsx(u.Control,{type:"text",disabled:!0,value:n.id})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"linecode_number",children:[e.jsx(u.Label,{children:"Flight"}),e.jsx(u.Control,{type:"text",disabled:!0,defaultValue:p.linecodeNumber})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"gate",children:[e.jsx(u.Label,{children:"Gate"}),e.jsx(u.Control,{type:"text",defaultValue:p.gate})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"city",children:[e.jsx(u.Label,{children:"City"}),e.jsx(u.Control,{type:"text",defaultValue:p.iata})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"status",children:[e.jsx(u.Label,{children:"Status"}),e.jsx(u.Control,{type:"text",defaultValue:p.statusCode})]}),e.jsx(N,{type:"submit",variant:"primary",children:"Save Changes"}),e.jsx("span",{className:"p-2"}),e.jsx(N,{variant:"secondary",onClick:o,children:"Cancel"})]})}),e.jsx(F.Footer,{})]})}const B="https://localhost:5001/v1/api/Dailies",E=600,R=-30;function O(){console.log("Using simple APIs V1");const[n,g]=C.useState(!1),[j,o]=C.useState({}),[i,p]=C.useState(1),[t,d]=C.useState([]);let c=50,h=1;const l=()=>{console.log("Fetching data");const a=`${B}/GetFlightsByTimeRange?rollOn=${E}&rollOff=${R}&maxRecords=${c}`;console.log("Fetching URL: "+a),fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}).then(m=>{if(!m.ok)throw new Error(`HTTP error! Status: ${m.status}`);return m.json()}).then(m=>{console.log("Data:",m),d(m)}).catch(m=>{console.error("Error fetching data:",m)})};C.useEffect(()=>{l()},[]);const r=()=>g(!1);function x(a){o(a),g(!0)}function s(a){a>=1&&a<=h?(console.log("Setting page to "+a),p(a)):console.log("Not setting page because page is out of range: "+a)}function b(a){var m=parseInt(a.target.text);console.log("itemClicked: "+m),s(m)}console.log("Current page: "+i);let f=[];for(let a=1;a<=h;a++)f.push(e.jsx(y.Item,{active:a===i,onClick:m=>b(m),children:a},a));return e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsxs(y,{children:[e.jsx(y.First,{onClick:()=>s(1),disabled:i==1}),e.jsx(y.Prev,{onClick:()=>s(i-1),disabled:i==1}),f,e.jsx(y.Next,{onClick:()=>s(i+1),disabled:i==h}),e.jsx(y.Last,{onClick:()=>s(h),disabled:i==h})]}),e.jsx(w,{xs:2,md:5,children:t.map(a=>e.jsx($,{className:"mb-3",children:e.jsx(T,{flight:a,fields:V,showFlight:x})},a.id))})]}),e.jsx(U,{show:n,flight:j,fields:V,handleClose:r})]})}export{O as default};
//# sourceMappingURL=FlightsSimple-4BIOIela.js.map
