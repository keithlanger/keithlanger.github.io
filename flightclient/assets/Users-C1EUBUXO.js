import{j as e,F as u,R as b,a as C,S as U,b as y,B as S,M as f}from"./bootstrap-C_lvuiKK.js";import{r as c}from"./vendor-D-ycbrtU.js";import{u as F,y as w}from"./index-DOI7CIXl.js";import"./router-Cwzx9i8E.js";const E=[{key:"userId",label:"User ID"},{key:"userName",label:"User Name"},{key:"userDescription",label:"User Description"},{key:"name1",label:"Name 1"},{key:"name2",label:"Name 2"},{key:"active",label:"Active"}];function D(t,n,s,i){return t[s]==null&&n[s]==null?0:t[s]==null?1:n[s]==null?-1:typeof t[s]=="string"?i==="asc"?t[s].localeCompare(n[s]):n[s].localeCompare(t[s]):i==="asc"?t[s]-n[s]:n[s]-t[s]}const z=({user:t,onSave:n})=>{const[s,i]=c.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mb-3 shadow-sm user-card-mini text-truncate",style:{cursor:"pointer",minWidth:0,maxWidth:260,width:"100%"},onClick:()=>i(!0),children:e.jsxs(y.Body,{className:"p-2 d-flex flex-column align-items-start justify-content-between",children:[e.jsxs("div",{className:"mb-1 text-truncate",style:{width:"100%"},children:[e.jsx("strong",{children:"ID:"})," ",t.userId]}),e.jsxs("div",{className:"mb-1 text-truncate",style:{width:"100%"},children:[e.jsx("strong",{children:"Name:"})," ",t.userName]}),e.jsxs("div",{className:"mb-2 text-truncate",style:{width:"100%",fontSize:"0.85em",color:"#888"},children:[e.jsx("strong",{children:"Active:"})," ",t.active?"Yes":"No"]}),e.jsx(S,{variant:"outline-primary",size:"sm",className:"align-self-end",onClick:j=>{j.stopPropagation(),i(!0)},children:"Details"})]})}),e.jsx(M,{show:s,onHide:()=>i(!1),user:t,onSave:n})]})};function M({show:t,onHide:n,user:s,onSave:i,mode:j="edit"}){const[d,h]=c.useState(s||{}),[x,m]=c.useState(!1),{authenticatedFetch:v}=F();c.useEffect(()=>{h(s||{})},[s,t]);const p=r=>{const{name:o,value:a,type:l,checked:N}=r.target;h(I=>({...I,[o]:l==="checkbox"?N:a}))},g=async()=>{m(!0);try{const r="https://dailyapisimple-gjchg7exhrcxf5cc.centralus-01.azurewebsites.net";let o,a;if(o=await v(`${r}/v2/api/users`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),!o.ok)throw new Error("Failed to save user");a=await o.json(),w.success("User updated"),i(a),n()}catch(r){w.error(r.message||"Error saving user")}finally{m(!1)}};return e.jsxs(f,{show:t,onHide:n,size:"lg",centered:!0,contentClassName:"user-modal-responsive",children:[e.jsx(f.Header,{closeButton:!0,children:e.jsx(f.Title,{children:"User Details"})}),e.jsx(f.Body,{style:{maxHeight:"60vh",overflowY:"auto",minHeight:200},children:e.jsx(u,{children:E.map(({key:r,label:o})=>e.jsxs(u.Group,{className:"mb-3",as:b,children:[e.jsx(u.Label,{column:!0,sm:4,xs:5,style:{fontWeight:500},children:o}),e.jsx(C,{sm:8,xs:7,children:r==="active"?e.jsx(u.Check,{type:"checkbox",name:r,checked:!!d[r],onChange:p,disabled:x}):e.jsx(u.Control,{name:r,value:d[r]??"",onChange:p,disabled:x||r==="userId",readOnly:r==="userId",type:typeof d[r]=="number"?"number":"text"})})]},r))})}),e.jsxs(f.Footer,{children:[e.jsx(S,{variant:"primary",onClick:g,disabled:x,children:x?e.jsx(U,{size:"sm",animation:"border"}):"Save"}),e.jsx(S,{variant:"secondary",onClick:n,disabled:x,children:"Cancel"})]})]})}const T=()=>{var o;const{user:t,authenticatedFetch:n}=F(),[s,i]=c.useState([]),[j,d]=c.useState(!0),[h,x]=c.useState({key:"userId",direction:"asc"}),[m,v]=c.useState({userName:""});c.useEffect(()=>{d(!0),n("https://dailyapisimple-gjchg7exhrcxf5cc.centralus-01.azurewebsites.net/v2/api/users").then(l=>{if(!l.ok)throw new Error("Failed to fetch users");return l.json()}).then(l=>i(l)).catch(l=>w.error(l.message||"Error loading users")).finally(()=>d(!1))},[n]);const p=c.useMemo(()=>s.filter(a=>!m.userName||(a.userName||"").toLowerCase().includes(m.userName.toLowerCase())),[s,m]),g=c.useMemo(()=>[...p].sort((a,l)=>D(a,l,h.key,h.direction)),[p,h]),r=a=>{i(l=>l.map(N=>N.userId===a.userId?a:N))};return!t||!((o=t.roles)!=null&&o.includes("admin"))?e.jsx("div",{className:"mt-4 text-danger",children:"Access denied."}):e.jsxs("div",{className:"container mt-4",children:[e.jsx("h2",{className:"mb-3",children:"Users"}),e.jsx(u,{className:"mb-3",children:e.jsx(b,{className:"g-2",children:e.jsx(C,{xs:12,sm:6,md:4,lg:3,xl:2,children:e.jsx(u.Control,{size:"sm",placeholder:"Filter by User Name",value:m.userName,onChange:a=>v(l=>({...l,userName:a.target.value}))})})})}),j?e.jsx("div",{className:"text-center my-5",children:e.jsx(U,{animation:"border"})}):e.jsx(b,{className:"g-2",children:g.map(a=>e.jsx(C,{xs:12,sm:6,md:4,lg:3,xl:2,xxl:2,children:e.jsx(z,{user:a,onSave:r})},a.userId))}),g.length===0&&!j&&e.jsx("div",{children:"No users found."})]})};export{T as default};
//# sourceMappingURL=Users-C1EUBUXO.js.map
