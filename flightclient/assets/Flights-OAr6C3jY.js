import{j as e,b as F,c as O,M as f,F as u,B as S,P as b,C as k,R as P,a as I}from"./bootstrap-6w9hth4I.js";import{h as B,f as T}from"./fields-DsoNZccK.js";import{r as v}from"./vendor-CAgi6j6b.js";import{a as E}from"./Constants-yCI1ju8d.js";import{y as N}from"./index-C4M0PWQL.js";import"./router-CE-yxLYx.js";function D(){const i="https://abc.dev.cloudids.aero/images/";function h(t,l){l||(l="h:mm A");var s=B(t).format(l);return s}function x(t,l,s,m,o){var g;m||(m="default"),o||(o="en");var c=a(t,s),r=`${s}/${c}/${o}/${m}`.toLowerCase(),C=((g=l[r])==null?void 0:g.value)??c;return C}function a(t,l){var m,o,c;var s=(c=(o=(m=t==null?void 0:t.fields)==null?void 0:m[l])==null?void 0:o[0])==null?void 0:c.value;return s}function n(t,l){var m,o,c,r;var s=(r=(c=(o=(m=t==null?void 0:t.fieldGroups)==null?void 0:m.codeshares)==null?void 0:o[0])==null?void 0:c[l])==null?void 0:r.value;return s||(s=a(t,l)),s}function j(t,l){var s={id:t.id,adi:t==null?void 0:t.adi,schedule:h(t==null?void 0:t.schedule),iata:a(t,"city"),city:x(t,l,"city"),logo:i+n(t,"logo"),linecode:n(t,"linecode"),number:n(t,"number"),gate:a(t,"gate"),status:x(t,l,"status"),statusCode:a(t,"status"),linecodeNumber:n(t,"linecode")+" "+n(t,"number")};return s}return{getFormattedFlight:j,formatTime:h,getLookup:x,getDailyValue:a,getCodeshareField:n}}const y=new D;function A({flight:i,showFlight:h,fields:x}){var a=y.getFormattedFlight(i,x);return e.jsx(F,{className:"myCard",onClick:()=>h(i),children:e.jsxs(F.Body,{children:[e.jsxs(F.Title,{children:[i.id," (",i.adi,") ",a.linecode,a.number]}),e.jsxs(O,{children:[e.jsx("img",{src:a.logo}),e.jsx("div",{children:a.iata}),e.jsx("div",{children:a.city}),e.jsx("div",{children:a.gate}),e.jsx("div",{children:a.status}),e.jsx("div",{children:a.schedule})]})]})})}function L({flight:i,fields:h,show:x,handleClose:a}){const n="https://abc.dev.cloudids.aero/dailyapi/v3/api/Dailies",j=y.getFormattedFlight(i,h),t=o=>{console.log("Patching flight "+o.id);const c=n+"/"+o.id;fetch(c,{method:"PATCH",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(o)}).then(r=>{if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);return r.json()}).then(r=>{console.log("Patching flight succeeded - Data:",r),a(),N.success("Record was saved successfully")}).catch(r=>{console.error("Error Patching flight:",r),N.error("Record did not save successfully.  Error reported: "+r)})};function l(){return y.getCodeshareField(i,"linecode")+" "+y.getCodeshareField(i,"number")}function s(o,c,r){var C=i.fields[o];let g=!1;(!C||C.length==0||C[0].value!=c)&&(g=!0),g&&(r[o]=[{instance:1,value:c}],i.fields[o]=r[o])}const m=o=>{o.preventDefault(),console.log("Submit"),console.log(o.target);const c={};s("gate",o.target.gate.value,c),s("city",o.target.city.value,c),s("status",o.target.status.value,c);var r={id:i.id,fields:c};console.log("Updating flight"),console.log(r),t(r)};return e.jsxs(f,{show:x,onHide:a,children:[e.jsx(f.Header,{closeButton:!0,children:e.jsx(f.Title,{children:l()})}),e.jsx(f.Body,{children:e.jsxs(u,{onSubmit:m,children:[e.jsxs(u.Group,{className:"mb-3",controlId:"id",children:[e.jsx(u.Label,{children:"ID"}),e.jsx(u.Control,{type:"text",disabled:!0,value:i.id})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"linecode_number",children:[e.jsx(u.Label,{children:"Flight"}),e.jsx(u.Control,{type:"text",disabled:!0,defaultValue:j.linecodeNumber})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"gate",children:[e.jsx(u.Label,{children:"Gate"}),e.jsx(u.Control,{type:"text",defaultValue:j.gate})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"city",children:[e.jsx(u.Label,{children:"City"}),e.jsx(u.Control,{type:"text",defaultValue:j.iata})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"status",children:[e.jsx(u.Label,{children:"Status"}),e.jsx(u.Control,{type:"text",defaultValue:j.statusCode})]}),e.jsx(S,{type:"submit",variant:"primary",children:"Save Changes"}),e.jsx("span",{className:"p-2"}),e.jsx(S,{variant:"secondary",onClick:a,children:"Cancel"})]})}),e.jsx(f.Footer,{})]})}const R={Operation:"between",Field:"schedule",CompareTo:"2022-06-07T14:50:10+00:00",CompareToEnd:"2022-06-10T14:50:10+00:00",Negate:!1,And:[],Or:[{Operation:"between",Field:"actual",CompareTo:"2022-06-07T14:50:10+00:00",CompareToEnd:"2022-06-10T14:50:10+00:00",Negate:!1,And:[],Or:[]},{Operation:">",Field:"holdtime",CompareTo:"2022-06-08T14:50:10+00:00",CompareToEnd:null,Negate:!1,And:[],Or:[]}]},$=[],G={filter:R,fieldsToInclude:$},M=U(G),V="https://abc.dev.cloudids.aero/dailyapi/v3/api/Dailies";function U(i){var h=JSON.parse(JSON.stringify(i));const x=1e3,a=-240,n=new Date,j=w(n,a),t=w(n,x),l=j.toISOString(),s=t.toISOString(),m=n.toISOString(),o=h.filter;return o.CompareTo=l,o.CompareToEnd=s,o.Or[0].CompareTo=l,o.Or[0].CompareToEnd=s,o.Or[1].CompareTo=m,h}function w(i,h){return new Date(i.getTime()+h*6e4)}function Q(){console.log("Using APVe APIs");const[i,h]=v.useState(!1),[x,a]=v.useState({}),[n,j]=v.useState(1),[t,l]=v.useState([]);let s=1;const m=()=>{console.log("Fetching data"),fetch(V+"/Search?skip=0&orderby=schedule&top="+10,{method:"POST",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(M)}).then(p=>{if(!p.ok)throw new Error(`HTTP error! Status: ${p.status}`);return p.json()}).then(p=>{console.log("Data:",p),l(p)}).catch(p=>{console.error("Error fetching data:",p)})};v.useEffect(()=>{m()},[]);const o=()=>h(!1);function c(d){a(d),h(!0)}function r(d){d>=1&&d<=s?(console.log("Setting page to "+d),j(d)):console.log("Not setting page because page is out of range: "+d)}function C(d){var p=parseInt(d.target.text);console.log("itemClicked: "+p),r(p)}console.log("Current page: "+n);let g=[];for(let d=1;d<=s;d++)g.push(e.jsx(b.Item,{active:d===n,onClick:p=>C(p),children:d},d));return e.jsxs(e.Fragment,{children:[e.jsxs(k,{children:[e.jsxs(b,{children:[e.jsx(b.First,{onClick:()=>r(1),disabled:n==1}),e.jsx(b.Prev,{onClick:()=>r(n-1),disabled:n==1}),g,e.jsx(b.Next,{onClick:()=>r(n+1),disabled:n==s}),e.jsx(b.Last,{onClick:()=>r(s),disabled:n==s})]}),e.jsx(P,{xs:2,md:5,children:t.map(d=>e.jsx(I,{className:"mb-3",children:e.jsx(A,{flight:d,fields:T,showFlight:c})},d.id))})]}),e.jsx(L,{show:i,flight:x,fields:T,handleClose:o})]})}export{Q as default};
//# sourceMappingURL=Flights-OAr6C3jY.js.map
