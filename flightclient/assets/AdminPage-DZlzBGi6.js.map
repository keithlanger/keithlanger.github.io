{"version":3,"file":"AdminPage-DZlzBGi6.js","sources":["../../src/components/AdminPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { useAdmin } from '../contexts/AdminContext';\r\nimport { Card, Button, Form, Spinner, Alert, Container, Row, Col } from 'react-bootstrap';\r\nimport { toast } from 'react-toastify';\r\n\r\nfunction AdminPage() {\r\n  const { user } = useAuth();\r\n  const admin = useAdmin();\r\n  if (!admin) return <Alert variant=\"danger\" className=\"mt-4\">Admin context not available.</Alert>;\r\n  const { buildState, buildFlightsForDate, clearBuildState, abortBuild } = admin;\r\n  const [date, setDate] = useState(buildState.date || '');\r\n  // Toast notifications for build completion/error are now handled globally in App.js\r\n\r\n  // Only allow access if user has 'admin' role\r\n  const roles = Array.isArray(user?.roles) ? user.roles : (typeof user?.roles === 'string' ? [user.roles] : []);\r\n  if (!roles.includes('admin')) {\r\n    return <Alert variant=\"danger\" className=\"mt-4\">You do not have permission to access this page.</Alert>;\r\n  }\r\n\r\n  const handleBuildFlights = (e) => {\r\n    e.preventDefault();\r\n    buildFlightsForDate(date);\r\n  };\r\n\r\n  return (\r\n    <Container className=\"py-4\">\r\n      <Row className=\"justify-content-center\">\r\n        <Col md={8} lg={6}>\r\n          <Card className=\"shadow-sm border-0 admin-tools-rounded\">\r\n            <Card.Header className=\"bg-primary text-white rounded-top-4\">\r\n              <h4 className=\"mb-0\">Administrator Tools</h4>\r\n            </Card.Header>\r\n            <Card.Body>\r\n              <Form onSubmit={handleBuildFlights} className=\"mb-3\">\r\n                <Form.Group controlId=\"buildFlightsDate\">\r\n                  <Form.Label>Build Flights for Date</Form.Label>\r\n                <Form.Control\r\n                  type=\"date\"\r\n                  value={date}\r\n                  onChange={e => setDate(e.target.value)}\r\n                  required\r\n                  disabled={buildState.loading}\r\n                />\r\n                </Form.Group>\r\n                <Button\r\n                  type=\"submit\"\r\n                  variant=\"primary\"\r\n                  className=\"mt-3\"\r\n                  disabled={buildState.loading || !date}\r\n                >\r\n                  {buildState.loading ? (\r\n                    <><Spinner animation=\"border\" size=\"sm\" className=\"me-2\" />Building Flights...</>\r\n                  ) : (\r\n                    'Build Flights'\r\n                  )}\r\n                </Button>\r\n                {buildState.loading && (\r\n                  <div className=\"d-flex align-items-center mt-3\">\r\n                    <Button variant=\"outline-danger\" className=\"me-2\" onClick={abortBuild} disabled={!buildState.loading}>\r\n                      Cancel\r\n                    </Button>\r\n                    <span className=\"text-muted\" style={{ fontSize: '0.85em' }}>\r\n                      <i className=\"bi bi-info-circle me-1\"></i>\r\n                      Cancel only stops this page from waiting. The backend job will continue running.\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </Form>\r\n              {buildState.result && (\r\n                <Alert variant=\"success\">\r\n                  Flights built successfully.<br />\r\n                  <pre className=\"mb-0\">{buildState.result}</pre>\r\n                  <Button variant=\"outline-secondary\" size=\"sm\" className=\"mt-2\" onClick={clearBuildState}>Dismiss</Button>\r\n                </Alert>\r\n              )}\r\n              {buildState.error && (\r\n                <Alert variant=\"danger\">{buildState.error}</Alert>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default AdminPage;\r\n"],"names":["AdminPage","user","useAuth","admin","useAdmin","jsx","Alert","buildState","buildFlightsForDate","clearBuildState","abortBuild","date","setDate","useState","handleBuildFlights","e","Container","Row","Col","jsxs","Card","Form","Button","Fragment","Spinner"],"mappings":"yNAMA,SAASA,GAAY,CACnB,KAAM,CAAE,KAAAC,CAAA,EAASC,EAAA,EACXC,EAAQC,EAAA,EACd,GAAI,CAACD,EAAO,OAAOE,EAAAA,IAACC,GAAM,QAAQ,SAAS,UAAU,OAAO,SAAA,8BAAA,CAA4B,EACxF,KAAM,CAAE,WAAAC,EAAY,oBAAAC,EAAqB,gBAAAC,EAAiB,WAAAC,GAAeP,EACnE,CAACQ,EAAMC,CAAO,EAAIC,EAAAA,SAASN,EAAW,MAAQ,EAAE,EAKtD,GAAI,EADU,MAAM,QAAQN,GAAA,YAAAA,EAAM,KAAK,EAAIA,EAAK,MAAS,OAAOA,GAAA,YAAAA,EAAM,QAAU,SAAW,CAACA,EAAK,KAAK,EAAI,CAAA,GAC/F,SAAS,OAAO,EACzB,aAAQK,EAAA,CAAM,QAAQ,SAAS,UAAU,OAAO,SAAA,kDAA+C,EAGjG,MAAMQ,EAAsBC,GAAM,CAChCA,EAAE,eAAA,EACFP,EAAoBG,CAAI,CAC1B,EAEA,aACGK,EAAA,CAAU,UAAU,OACnB,SAAAX,EAAAA,IAACY,GAAI,UAAU,yBACb,SAAAZ,EAAAA,IAACa,EAAA,CAAI,GAAI,EAAG,GAAI,EACd,SAAAC,EAAAA,KAACC,EAAA,CAAK,UAAU,yCACd,SAAA,CAAAf,EAAAA,IAACe,EAAK,OAAL,CAAY,UAAU,sCACrB,eAAC,KAAA,CAAG,UAAU,OAAO,SAAA,qBAAA,CAAmB,CAAA,CAC1C,EACAD,EAAAA,KAACC,EAAK,KAAL,CACC,SAAA,CAAAD,EAAAA,KAACE,EAAA,CAAK,SAAUP,EAAoB,UAAU,OAC5C,SAAA,CAAAK,EAAAA,KAACE,EAAK,MAAL,CAAW,UAAU,mBACpB,SAAA,CAAAhB,EAAAA,IAACgB,EAAK,MAAL,CAAW,SAAA,wBAAA,CAAsB,EACpChB,EAAAA,IAACgB,EAAK,QAAL,CACC,KAAK,OACL,MAAOV,EACP,SAAUI,GAAKH,EAAQG,EAAE,OAAO,KAAK,EACrC,SAAQ,GACR,SAAUR,EAAW,OAAA,CAAA,CACvB,EACA,EACAF,EAAAA,IAACiB,EAAA,CACC,KAAK,SACL,QAAQ,UACR,UAAU,OACV,SAAUf,EAAW,SAAW,CAACI,EAEhC,SAAAJ,EAAW,QACVY,EAAAA,KAAAI,EAAAA,SAAA,CAAE,SAAA,CAAAlB,MAACmB,GAAQ,UAAU,SAAS,KAAK,KAAK,UAAU,OAAO,EAAE,qBAAA,CAAA,CAAmB,EAE9E,eAAA,CAAA,EAGHjB,EAAW,SACVY,OAAC,MAAA,CAAI,UAAU,iCACb,SAAA,CAAAd,EAAAA,IAACiB,EAAA,CAAO,QAAQ,iBAAiB,UAAU,OAAO,QAASZ,EAAY,SAAU,CAACH,EAAW,QAAS,SAAA,QAAA,CAEtG,EACAY,OAAC,QAAK,UAAU,aAAa,MAAO,CAAE,SAAU,UAC9C,SAAA,CAAAd,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAA,CAAyB,EAAI,kFAAA,CAAA,CAE5C,CAAA,CAAA,CACF,CAAA,EAEJ,EACCE,EAAW,QACVY,OAACb,EAAA,CAAM,QAAQ,UAAU,SAAA,CAAA,oCACK,KAAA,EAAG,EAC/BD,EAAAA,IAAC,MAAA,CAAI,UAAU,OAAQ,WAAW,OAAO,EACzCA,EAAAA,IAACiB,EAAA,CAAO,QAAQ,oBAAoB,KAAK,KAAK,UAAU,OAAO,QAASb,EAAiB,SAAA,SAAA,CAAO,CAAA,EAClG,EAEDF,EAAW,OACVF,EAAAA,IAACC,GAAM,QAAQ,SAAU,WAAW,KAAA,CAAM,CAAA,CAAA,CAE9C,CAAA,EACF,CAAA,CACF,EACF,EACF,CAEJ"}