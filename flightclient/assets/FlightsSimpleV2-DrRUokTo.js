import{j as e,b as f,c as P,M as C,F as u,B as k,P as y,C as $,R as B,a as I}from"./bootstrap-6w9hth4I.js";import{h as L,f as U}from"./fields-DsoNZccK.js";import{r as F}from"./vendor-CAgi6j6b.js";import{y as w}from"./index-C4M0PWQL.js";import"./router-CE-yxLYx.js";function T(){const i="https://abc.dev.cloudids.aero/images/";function g(t,n){n||(n="h:mm A");var d=L(t).format(n);return d}function p(t,n,d,r,x){var m;r||(r="default"),x||(x="en");var s=o(t,d),l=`${d}/${s}/${x}/${r}`.toLowerCase(),j=((m=n[l])==null?void 0:m.value)??s;return j}function o(t,n){var r,x,s;var d=(s=(x=(r=t==null?void 0:t.fields)==null?void 0:r[n])==null?void 0:x[0])==null?void 0:s.value;return d}function c(t,n){var r,x,s,l;var d=(l=(s=(x=(r=t==null?void 0:t.fieldGroups)==null?void 0:r.codeshares)==null?void 0:x[0])==null?void 0:s[n])==null?void 0:l.value;return d||(d=o(t,n)),d}function b(t,n){var d={id:t.id,adi:t==null?void 0:t.adi,schedule:g(t==null?void 0:t.schedule),iata:o(t,"city"),city:p(t,n,"city"),logo:i+c(t,"logo"),linecode:c(t,"linecode"),number:c(t,"number"),gate:o(t,"gate"),status:p(t,n,"status"),statusCode:o(t,"status"),linecodeNumber:c(t,"linecode")+" "+c(t,"number")};return d}return{getFormattedFlight:b,formatTime:g,getLookup:p,getDailyValue:o,getCodeshareField:c}}const v=new T;function V({flight:i,showFlight:g,fields:p}){var o=v.getFormattedFlight(i,p);return e.jsx(f,{className:"myCard",onClick:()=>g(i),children:e.jsxs(f.Body,{children:[e.jsxs(f.Title,{children:[i.id," (",i.adi,") ",o.linecode,o.number]}),e.jsxs(P,{children:[e.jsx("img",{src:o.logo}),e.jsx("div",{children:o.iata}),e.jsx("div",{children:o.city}),e.jsx("div",{children:o.gate}),e.jsx("div",{children:o.status}),e.jsx("div",{children:o.schedule})]})]})})}function D({flight:i,fields:g,show:p,handleClose:o}){const b="https://dailyapisimple-gjchg7exhrcxf5cc.centralus-01.azurewebsites.net/v2/api/Dailies";console.log("dailiesBaseUrl (flight modal): "+b);const t=v.getFormattedFlight(i,g),n=(s,l)=>{console.log("Updating flight "+s);const j=b+"/UpdateDailyValues/"+s;fetch(j,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then(m=>{if(!m.ok)throw new Error(`HTTP error! Status: ${m.status}`);return m.json()}).then(m=>{console.log("Updating flight succeeded - Data:",m),o(),w.success("Record was saved successfully")}).catch(m=>{console.error("Error Updating flight:",m),w.error("Record did not save successfully.  Error reported: "+m)})};function d(){return v.getCodeshareField(i,"linecode")+" "+v.getCodeshareField(i,"number")}function r(s,l,j){var m={field:s,instance:1,value:l};j.push(m),i.fields[s]=[{instance:1,value:l}]}const x=s=>{s.preventDefault(),console.log("Submit"),console.log(s.target);const l=[];r("gate",s.target.gate.value,l),r("city",s.target.city.value,l),r("status",s.target.status.value,l),console.log("Updating flight "+i.id),console.log(l),n(i.id,l)};return e.jsxs(C,{show:p,onHide:o,children:[e.jsx(C.Header,{closeButton:!0,children:e.jsx(C.Title,{children:d()})}),e.jsx(C.Body,{children:e.jsxs(u,{onSubmit:x,children:[e.jsxs(u.Group,{className:"mb-3",controlId:"id",children:[e.jsx(u.Label,{children:"ID"}),e.jsx(u.Control,{type:"text",disabled:!0,value:i.id})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"linecode_number",children:[e.jsx(u.Label,{children:"Flight"}),e.jsx(u.Control,{type:"text",disabled:!0,defaultValue:t.linecodeNumber})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"gate",children:[e.jsx(u.Label,{children:"Gate"}),e.jsx(u.Control,{type:"text",defaultValue:t.gate})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"city",children:[e.jsx(u.Label,{children:"City"}),e.jsx(u.Control,{type:"text",defaultValue:t.iata})]}),e.jsxs(u.Group,{className:"mb-3",controlId:"status",children:[e.jsx(u.Label,{children:"Status"}),e.jsx(u.Control,{type:"text",defaultValue:t.statusCode})]}),e.jsx(k,{type:"submit",variant:"primary",children:"Save Changes"}),e.jsx("span",{className:"p-2"}),e.jsx(k,{variant:"secondary",onClick:o,children:"Cancel"})]})}),e.jsx(C.Footer,{})]})}const E="https://dailyapisimple-gjchg7exhrcxf5cc.centralus-01.azurewebsites.net",N=`${E}/v2/api/Dailies`;console.log("dailiesBaseUrl: "+N);const G=600,R=-30;function J(){console.log("Using simple APIs V2");const[i,g]=F.useState(!1),[p,o]=F.useState({}),[c,b]=F.useState(1),[t,n]=F.useState([]);let d=50,r=1;const x=()=>{console.log("Fetching data");const a=`${N}/GetFlightsByTimeRange?rollOn=${G}&rollOff=${R}&maxRecords=${d}`;console.log("Fetching URL: "+a),fetch(a,{method:"GET",headers:{"Content-Type":"application/json"}}).then(h=>{if(!h.ok)throw new Error(`HTTP error! Status: ${h.status}`);return h.json()}).then(h=>{console.log("Data:",h),n(h)}).catch(h=>{console.error("Error fetching data:",h)})};F.useEffect(()=>{x()},[]);const s=()=>g(!1);function l(a){o(a),g(!0)}function j(a){a>=1&&a<=r?(console.log("Setting page to "+a),b(a)):console.log("Not setting page because page is out of range: "+a)}function m(a){var h=parseInt(a.target.text);console.log("itemClicked: "+h),j(h)}console.log("Current page: "+c);let S=[];for(let a=1;a<=r;a++)S.push(e.jsx(y.Item,{active:a===c,onClick:h=>m(h),children:a},a));return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsxs(y,{children:[e.jsx(y.First,{onClick:()=>j(1),disabled:c==1}),e.jsx(y.Prev,{onClick:()=>j(c-1),disabled:c==1}),S,e.jsx(y.Next,{onClick:()=>j(c+1),disabled:c==r}),e.jsx(y.Last,{onClick:()=>j(r),disabled:c==r})]}),e.jsx(B,{xs:2,md:5,children:t.map(a=>e.jsx(I,{className:"mb-3",children:e.jsx(V,{flight:a,fields:U,showFlight:l})},a.id))})]}),e.jsx(D,{show:i,flight:p,fields:U,handleClose:s})]})}export{J as default};
//# sourceMappingURL=FlightsSimpleV2-DrRUokTo.js.map
